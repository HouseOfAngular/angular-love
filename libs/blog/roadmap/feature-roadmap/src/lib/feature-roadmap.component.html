<svg #svg width="100%" height="100%" xmlns:svg="http://www.w3.org/1999/html">
  <svg:defs>
    <marker
      id="arrowhead"
      markerWidth="6"
      markerHeight="8"
      refX="0"
      refY="4"
      orient="auto"
    >
      <polygon points="0 0, 6 4, 0 8" fill="#FDF5FD" />
    </marker>
  </svg:defs>

  <svg:foreignObject height="0" width="0" overflow="visible">
    <div
      class="flex h-fit w-fit translate-x-80 translate-y-16 flex-col items-center gap-16"
    >
      @for (layer of roadmapLayers(); track layer.parentNode.id) {
        <div class="flex w-full flex-col items-center gap-12">
          @if (layer.parentNode.nodeType === 'primary') {
            <al-ui-roadmap-primary-node [node]="layer.parentNode" />
          } @else if (layer.parentNode.nodeType === 'angular-love') {
            <al-ui-roadmap-angular-love-node
              [node]="layer.parentNode"
            ></al-ui-roadmap-angular-love-node>
          }
          @if (layer.childNodes?.length) {
            <div class="flex gap-12">
              @for (node of layer.childNodes | leftSlice; track node.id) {
                <div class="flex gap-10">
                  @if (node.nodeType === 'secondary') {
                    <al-ui-roadmap-secondary-node [node]="node" />
                  } @else if (node.nodeType === 'cluster') {
                    <al-ui-roadmap-cluster
                      [cluster]="$any(node)"
                    ></al-ui-roadmap-cluster>
                  }
                </div>
              }
              @for (node of layer.childNodes | rightSlice; track node.id) {
                <div class="flex gap-10">
                  @if (node.nodeType === 'secondary') {
                    <al-ui-roadmap-secondary-node [node]="node" />
                  } @else if (node.nodeType === 'cluster') {
                    <al-ui-roadmap-cluster
                      [cluster]="$any(node)"
                    ></al-ui-roadmap-cluster>
                  }
                </div>
              }
            </div>
          }
        </div>
      }
    </div>
  </svg:foreignObject>
</svg>
