@defer (hydrate on viewport) {
  <svg width="100%" height="100%" xmlns:svg="http://www.w3.org/1999/html">
    <svg:defs>
      <marker
        id="arrowhead"
        markerWidth="6"
        markerHeight="8"
        refX="0"
        refY="4"
        orient="auto"
      >
        <polygon points="0 0, 6 4, 0 8" fill="#FDF5FD" />
      </marker>
    </svg:defs>

    <svg:foreignObject height="0" width="0" overflow="visible">
      <div
        class="flex h-fit w-fit translate-x-80 translate-y-6 flex-col items-center gap-16"
      >
        @for (layer of roadmapLayers(); track layer.parentNode.id) {
          <div class="flex w-full flex-col items-center gap-12">
            <al-ui-roadmap-node
              [data]="{
                title: layer.parentNode.title,
                nodeType: layer.parentNode.nodeType,
              }"
            />
            @if (layer.childNodes?.length) {
              <div class="flex gap-12">
                @for (node of layer.childNodes | leftSlice; track node.id) {
                  <div class="flex gap-10">
                    <al-ui-roadmap-node
                      [data]="{
                        title: node.title,
                        nodeType: node.nodeType,
                      }"
                    />
                  </div>
                }
                @for (node of layer.childNodes | rightSlice; track node.id) {
                  <div class="flex gap-10">
                    <al-ui-roadmap-node
                      [data]="{
                        title: node.title,
                        nodeType: node.nodeType,
                      }"
                    />
                  </div>
                }
              </div>
            }
          </div>
        }
      </div>
    </svg:foreignObject>
  </svg>
}
