<al-card alGradientCard>
  <section alCardContent aria-labelledby="newsletter-title" aria-live="polite">
    <ng-container *transloco="let t; read: 'newsletter'">
      <form data-testid="newsletter-form" [formGroup]="form">
        <div class="flex flex-col">
          <h2
            id="newsletter-title"
            class="text-al-primary-foreground text-4xl font-bold lg:text-2xl xl:text-4xl"
          >
            {{ t('title') }}
          </h2>
          <p class="py-4">{{ t('description') }}</p>
          <fieldset>
            <legend class="hidden">Newsletter sign up form</legend>

            <input
              aria-required="true"
              type="text"
              class="bg-al-background text-al-muted border-al-border my-2 h-[60px] w-full grow rounded-md border p-6 text-sm"
              [attr.aria-label]="t('namePlaceholder')"
              [placeholder]="t('namePlaceholder')"
              formControlName="name"
            />

            <div class="my-2 flex w-full flex-row">
              <input
                aria-required="true"
                type="email"
                class="bg-al-background text-al-muted border-al-border h-[60px] w-full grow rounded-l-md border border-r-0 p-6 text-sm"
                [attr.aria-label]="t('emailPlaceholder')"
                [placeholder]="t('emailPlaceholder')"
                formControlName="email"
              />
              <button
                al-button
                type="button"
                class="bg-al-pink rounded-l-none text-white"
                [attr.aria-label]="t('submitLabel')"
                [disabled]="!form.valid"
                (click)="postEmailAddress()"
                size="small"
              >
                <fast-svg name="send" aria-hidden="true" size="20" />
              </button>
            </div>
            <div class="group mt-2 lg:mt-4">
              <input
                id="newsletter-checkbox"
                aria-labelledby="newsletter-label"
                aria-required="true"
                type="checkbox"
                class="newsletter-checkbox peer hidden"
                formControlName="checkbox"
              />
              <label
                id="newsletter-label"
                class="text-al-muted flex flex-col [&>div>div>div]:peer-checked:block"
                for="newsletter-checkbox"
              >
                @if (newsletterStoreLoading() === 'error') {
                  <p class="font-bold">{{ t('error') }}</p>
                }
                <div class="flex">
                  <div
                    tabindex="0"
                    aria-describedby="consent-text"
                    role="checkbox"
                    class="border-al-muted group-has-checked:border-al-pink mt-1 mr-2 flex aspect-square h-[14px] items-center justify-center rounded-sm border"
                    [attr.aria-label]="t('label')"
                    [attr.aria-checked]="form.controls.checkbox.value"
                    (keydown.space)="
                      $event.stopPropagation();
                      $event.preventDefault();
                      form.controls['checkbox'].setValue(
                        !form.controls['checkbox'].value
                      )
                    "
                  >
                    <div
                      class="bg-al-pink hidden h-[6px] w-[6px] rounded-xs group-has-checked:block"
                    ></div>
                  </div>
                  <span
                    id="consent-text"
                    class="before:text-al-pink text-sm before:content-['*']"
                  >
                    {{ t('consent') }}
                  </span>
                </div>
              </label>
            </div>
          </fieldset>
        </div>
      </form>
    </ng-container>
  </section>
</al-card>
